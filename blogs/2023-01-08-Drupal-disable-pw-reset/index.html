<p>In one particular site, we chose to block the user registration and user password reset options. The site is using SSO login anyway, so this would really only impact our development team's superuser admin account (user 1) that is typically blocked outside of an emergency, so this seals up a possible attack vector with no user impact.</p>
<p>User registration can also be blocked with site configuration, so I wouldn't have bothered with custom code for only that part. But since I was doing it for the password reset anyway, I decided to go ahead with the extra layer of protection on the registration route as well.</p>
<p>I achieved this with a simple custom module which you can view in full <a href="https://github.com/ryan-l-robinson/Drupal-disable-password-reset">in my GitHub</a>. Here's the key part, blocking access to the routes:</p>
<pre class="language-php" tabindex="0"><code class="language-php">  <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">alterRoutes</span><span class="token punctuation">(</span><span class="token class-name type-declaration">RouteCollection</span> <span class="token variable">$collection</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Always deny access to unwanted routes.</span>
    <span class="token variable">$disallow_routes</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token string single-quoted-string">'user.register'</span><span class="token punctuation">,</span>
      <span class="token string single-quoted-string">'user.pass'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$disallow_routes</span> <span class="token keyword">as</span> <span class="token variable">$disallow_route</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$route</span> <span class="token operator">=</span> <span class="token variable">$collection</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$disallow_route</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$route</span><span class="token operator">-></span><span class="token function">setRequirement</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'_access'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'FALSE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></code></pre>
