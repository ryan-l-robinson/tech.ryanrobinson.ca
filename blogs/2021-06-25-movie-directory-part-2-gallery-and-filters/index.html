<p>In <a href="/microsoft-365/power-apps/movie-directory-part-1-the-data/">Movie Directory Part 1</a>, I described what I was aiming to achieve with this personal project, as well as the Dataverse structure.</p>
<p>In this post, I’ll describe at a high level the design of the Power App and the gallery view and filters. Most of it I’ll keep at a high-level, not step-by-step, as I used a lot of the out-of-the-box functionality.</p>
<h2 id="screens" tabindex="-1">Screens <a class="header-anchor" href="#screens">#</a></h2>
<p>There are four screens involved in the app:</p>
<ul>
<li>Gallery view that shows all of the movies, with the cover art behind the title, year, and last time we watched it</li>
<li>Filters screen that allows you to specify filters that apply on the gallery view</li>
<li>View details screen of a single movie</li>
<li>Edit details screen of a single movie, including a new movie</li>
</ul>
<h2 id="all-movies" tabindex="-1">All Movies <a class="header-anchor" href="#all-movies">#</a></h2>
<p><img src="/assets/img/2021/06/Gallery-view.png" alt="">
<em>Gallery view. We own all the Alien movies</em></p>
<p>The majority of this screen is a Gallery component, with some minor changes to show exact details I wanted to show. The biggest change is incorporating the filters from the filters screen, which required this in the OnVisible field to handle whether there are filters set or not:</p>
<pre><code>Set(MoviesFilter1,If(!IsBlank(varWatchlist)&amp;&amp;varWatchlist&lt;&gt;&quot;None&quot;,Filter(Movies,Text(Watchlist)=varWatchlist),Movies));
Set(MoviesFilter2,If(!IsBlank(varOwned),Filter(MoviesFilter1,varOwned in Owned),MoviesFilter1));
Set(MoviesFilter3,If(!IsBlank(varLastWatched),Filter(MoviesFilter2,'Last Watched'&gt;=varLastWatched||IsBlank('Last Watched')),MoviesFilter2));
</code></pre>
<p>And this in the Items field to only show those with the right filters:</p>
<pre><code>SortByColumns(
    If(IsBlank(TextSearchBox1.Text),MoviesFilter3, Filter(Movies,TextSearchBox1.Text in Text(Name))),
        &quot;crfa4_name&quot;, 
        If(SortDescending1, SortOrder.Descending, SortOrder.Ascending)
    )
</code></pre>
<p>The OnSelect field of the Overlay on the gallery has this, to navigate to viewing that specific movie:</p>
<pre><code>Navigate(ViewMovieDetails,ScreenTransition.Fade)
</code></pre>
<p>Setting the background image was a bit simpler, putting this into the Image field of the Image component in the Gallery:</p>
<pre><code>ThisItem.Cover.Full
</code></pre>
<p>Another minor tweak included adding the Filters icon, which navigates to the filters screen with this formula in the OnSelect:</p>
<pre><code>Navigate(MovieFilters)
</code></pre>
<h2 id="filters" tabindex="-1">Filters <a class="header-anchor" href="#filters">#</a></h2>
<p><img src="/assets/img/2021/06/Filters.png" alt="">
<em>Filters screen</em></p>
<p>The filters screen is nothing flashy, but functional. The watchlist field is a simple dropdown, where the items field comes from the Dataverse tables:</p>
<pre><code>Choices(Movies.Watchlist)
</code></pre>
<p>Similar for the Owned Platform field:</p>
<pre><code>Choices(Movies.Owned)
</code></pre>
<p>Hide Movies Watched Since is a standard date picker field, but those are hard to blank out if you had that set and then wanted to turn it off, so I had to add an accompanying button with this OnSelect value:</p>
<pre><code>Reset(LastWatchedFilter)
</code></pre>
<p>The hardest part is the Save button, which needed to update the filter variables and navigate back to the gallery view, so this goes into the OnSelect for that button:</p>
<pre><code>Set(varWatchlist,WatchlistFilter.SelectedText.Value);
Set(varOwned,OwnedFilter.Selected.Value);
Set(varLastWatched,LastWatchedFilter.SelectedDate);
Navigate(AllMovies)
</code></pre>
<p>That’s it for the gallery view and filtering. The next post in this series will describe viewing and editing of a single movie.</p>
