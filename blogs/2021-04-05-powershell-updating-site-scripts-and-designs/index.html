<p>This post begins a series on <a href="/eleventy-base-blog/tags/sharepoint-site-provisioning/">SharePoint site provisioning</a>, unpacking some of the problems I’ve faced and overcome in building SharePoint site provisioning solutions.</p>
<p><a href="https://docs.microsoft.com/en-us/sharepoint/dev/declarative-customization/site-design-overview">Site scripts and site designs</a> are a great feature of SharePoint. They allow for developing and using templates on SharePoint sites that can do many useful things like:</p>
<ul>
<li>Create a list or library</li>
<li>Apply column or view formatting on a list or library</li>
<li>Apply a site logo image</li>
</ul>
<p>There is one annoying limitation, though. These scripts and designed are entirely created through PowerShell. That can make it a pain when you’re testing out a new script and need to update it frequently with each change, especially if you’re handling multiple scripts at once.</p>
<p>So I wrote some PowerShell that handled some basic logic for me:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-online/connect-sposervice?view=sharepoint-ps">Connect to the Microsoft 365 account</a></li>
<li><a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-online/get-spositescript?view=sharepoint-ps">Check if the script already exists</a></li>
<li>If yes, <a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-online/set-spositescript?view=sharepoint-ps">update that script </a>reading from the latest file with an incremented version number</li>
<li>If no, <a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-online/add-spositescript?view=sharepoint-ps">create a new site script</a></li>
<li><a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-online/get-spositedesign?view=sharepoint-ps">Check if the site design already exists</a></li>
<li>If yes, <a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-online/set-spositedesign?view=sharepoint-ps">update that design to include the relevant scripts</a>, with an incremented version number</li>
<li>If no, <a href="https://docs.microsoft.com/en-us/powershell/module/sharepoint-online/add-spositedesign?view=sharepoint-ps">create a new design to include the relevant scripts</a></li>
</ul>
<p>The code is available on <a href="https://github.com/ryan-l-robinson/SharePoint-Site-Update">my GitHub account</a>. The current version is minimal, but I may return someday to make some more updates to it like how to automate multiple scripts on the same design.</p>
<p>With this PowerShell script, you only need to tweak it to fit your scheme, and then run the PowerShell each time you need to upload your site script’s changes to your SharePoint tenant. The README file on GitHub provides more detail.</p>
