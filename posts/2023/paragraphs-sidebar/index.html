<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Drupal: Paragraphs Sidebar</title>
		<meta name="description" content="Technologist writing about web development, Microsoft 365, and more.">

  		<link rel="icon" type="image/x-icon" href="/img/favicon.ico">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Ryan Robinson Technology">
		<link rel="alternate" href="/feed/feed.json" type="application/json" title="Ryan Robinson Technology">
		<link rel="stylesheet" href="/bundle/1701Y3RM_l.css">
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>
		<header>
			<div class="container header-container">
				<p>Ryan Robinson Technology</p>
				<p>Search box goes here?</p>
				<nav class="top-nav" aria-describedby="top-nav">
					<h2 class="visually-hidden" id="top-nav">Top level navigation menu</h2>
					<ul class="top-nav-list">
						<li class="nav-item"><a href="/">Home</a></li>
						<li class="nav-item"><a href="/about/">About</a></li>
						<li class="nav-item"><a href="/tools/">Tools</a></li>
					</ul>
				</nav>
			</div>
		</header>

		<main id="skip">
			<div class="container">
				
<h1>Drupal: Paragraphs Sidebar</h1>

<div class="post-metadata">
	<p><time datetime="2023-03-29">March 29, 2023</time></p>
	
		<p>Tags:
		<a href="/tags/drupal/" class="post-tag">Drupal</a>
		</p>
	
</div>




<p>Suppose you want to be able to specify a contact person for most nodes of content on a site, which will then show up in the sidebar with a label and some information about the contact person. Each node could have zero contacts, could have one contact, or could have several contacts.</p>
<p>I solved this using a combination of <a href="https://www.drupal.org/project/paragraphs">the Paragraph module</a>, <a href="https://www.drupal.org/project/profile">the Profile module</a>, content type fields, and views. A demo of this is available in <a href="https://github.com/ryan-l-robinson/Drupal-paragraphs-sidebar">my GitHub</a> that you can load up using <a href="https://www.gitpod.io/">GitPod</a>.</p>
<h2 id="create-the-paragraph-and-its-fields" tabindex="-1">Create the paragraph and its fields <a class="header-anchor" href="#create-the-paragraph-and-its-fields">#</a></h2>
<p>First, create the paragraph and its corresponding fields. In my case, I wanted two fields: a label that will be displayed, and a user reference to connect to a staff user account.</p>
<p>I created the paragraph type and called it “Contact.”</p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-create-paragraph.PNG" alt="&quot;Creating a paragraph type called Contact&quot;"></p>
<p>Next, add a field for the label, as a text select to choose from a few pre-defined options including &quot;Primary Contact,&quot; &quot;Secondary Contact,&quot; etc. Only allow one label per paragraph, which is different from where we'll later allow multiple paragraphs per node.</p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-create-label-field.PNG" alt="&quot;Creating a field called Contact Label, as a Text (List) type&quot;"></p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-label-settings.PNG" alt="&quot;Settings for the label field, including the valid options and to allow allow 1 value.&quot;"></p>
<p>Finally, add a field for the user reference. Set this up to show up as an autocomplete, filtering to only show those who are of the Staff role.</p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-create-user-field.PNG" alt="&quot;Creating a user entity reference field called Contact User&quot;"></p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-user-filter.PNG" alt="&quot;The user entity reference settings, filtering to only show those of the role Staff&quot;"></p>
<h2 id="assign-to-a-content-type" tabindex="-1">Assign to a content type <a class="header-anchor" href="#assign-to-a-content-type">#</a></h2>
<p>Add a field on the content type that references this paragraph. The field type is going to be an entity reference revision.</p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-add-field-to-content-type.PNG" alt="&quot;Adding the paragraph reference to the Page content type&quot;"></p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-entity-reference-paragraph-type.PNG" alt="&quot;The settings for the entity field, filtering to be able to select paragraphs of type Contact&quot;"></p>
<p>In this case, since it's going to display it in the sidebar using a view, also remove it from the display for the content type. I won't get into details of designing the page on this post.</p>
<p>This step can be repeated to add the field to multiple content types, so that you can have the consistent design on all of them.</p>
<h2 id="create-the-profile" tabindex="-1">Create the profile <a class="header-anchor" href="#create-the-profile">#</a></h2>
<p>For the sake of this demo, I'll only add a couple of fields to the profile - a name, a phone number, and an email - and I won't do any of the design of the profile page, just creating the fields for the purpose of showing it in the sidebar of the content.</p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-profile-fields.PNG" alt="&quot;Created fields for the profile: name, phone, and email&quot;"></p>
<h2 id="create-sidebar-view" tabindex="-1">Create sidebar view <a class="header-anchor" href="#create-sidebar-view">#</a></h2>
<p>That's all the underlying structure. We can now proceed to creating the view itself. This will be a view of content, because while it will be showing paragraphs, it will be showing those paragraphs based on the content being viewed. It will be a block, since we're going to want blocks that can be placed in theme block regions.</p>
<p><img src="/assets/img/2023/03/Paragraphs-sidebar-start-view.PNG" alt="&quot;Settings for creating the view. The essential component is the view settings showing Content.&quot;"></p>
<p>Next, make a contextual filter so it will only show content related to the current content on display. This will be on the node ID of the page being viewed, so that only paragraphs related to the current node will come up as results. Create a filter for content ID and set the default to be &quot;Content ID from URL.&quot;</p>
<p><img src="/assets/img/2023/03/paragraphs-sidebar-contextual-filter.jpg" alt="&quot;Settings for the contextual filter, the content ID set to default on the content ID in the URL.&quot;"></p>
<p>Now we need to create the link between the page being viewed and its contact paragraphs. This can be done with the relationships functionality of views. Under Relationships, click on Add, then select &quot;Paragraph referenced from field_contact.&quot;</p>
<p><img src="/assets/img/2023/03/paragraphs-sidebar-relationship.jpg" alt="&quot;Adding a relationship to paragraph referenced from field_contact.&quot;"></p>
<p>We then need two more relationships:</p>
<ol>
<li>From the contact field of the paragraph back to the user: &quot;User referenced from field_contact_user.&quot;</li>
<li>From the user to the profile, which will have the majority of the fields we want to display: &quot;Profile.&quot;</li>
</ol>
<p>The last setting we'll change in the Advanced section is near the bottom: set &quot;Hide block if the view output is empty&quot; to Yes. We don't want it to show up at all if there isn't a contact for the current content.</p>
<p>Now that we've built the complexities of the query, we can return to the more common configuration in the left pane to determine what is shown. I set:</p>
<ul>
<li>Display for the view to an unformatted list of fields.</li>
<li>The fields are the contact name, the contact label, the phone number, and the email address, all from the associated profile. Each field is set to be hidden if there is no result, in case a profile is created with some information but not others, e.g. somebody offers their email but doesn't want to share their phone. You can also add more styling around how these get displayed (labels, links, etc).</li>
<li>Filter on the paragraph type to be &quot;Contact,&quot; on the paragraph to be published, and for the user to be active. This helps avoid unexpected results when a user is later blocked, or somehow another paragraph type is associated to the content.</li>
<li>Sort by the contact label and then by contact name, which will be more intuitive to users than sorting on something else like authored date.</li>
</ul>
<p>We can go back to the settings on the Unformmated list to group results by the label, so that the label will show up as a header. If you want more precise control over what HTML tags are used for which elements, <a href="https://www.drupal.org/project/semanticviews">semantic views</a> is another great module.</p>
<h2 id="place-block-view-in-sidebar" tabindex="-1">Place block view in sidebar <a class="header-anchor" href="#place-block-view-in-sidebar">#</a></h2>
<p>Finally, add the block to show in that sidebar for all relevant content types. Of course this will depend on your theme having a sidebar region, but most have at least one.</p>
<p><img src="/assets/img/2023/03/paragraphs-sidebar-block.jpg" alt="&quot;Adding a block to appear in the sidebar of the Page content type&quot;"></p>
<h2 id="final-result" tabindex="-1">Final result <a class="header-anchor" href="#final-result">#</a></h2>
<p>Here's an example of what all of this looks like, at its most basic level without any extra CSS styles added:</p>
<p><img src="/assets/img/2023/03/paragraphs-sidebar-demo.jpg" alt="&quot;Sidebar in place on a demo page, showing the Primary Contact label, name Ryan Robinson linked to the profile, email address, and phone number as a valid phone link.&quot;"></p>

<div class="links-nextprev"><p>Previous: <a href="/posts/2023/drupal-recycle-bin/">Drupal: Recycle Bin</a></p><p>Next: <a href="/posts/2023/drupal-openai/">Drupal: OpenAI Module</a></p>
</div>
			</div>
		</main>

		<footer>
			<div class="container">
				<ul class="social-links">
					<li>
						<a rel="me" href="https://ryanrobinson.ca">
							<span class="visually-hidden">Ryan Robinson Homepage</span>
							<svg xmlns="http://www.w3.org/2000/svg" height="40" width="40" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64l-185.3 0c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64l185.3 0c2.2 20.4 3.3 41.8 3.3 64zm28.8-64l123.1 0c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64l-123.1 0c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32l-116.7 0c-10-63.9-29.8-117.4-55.3-151.6c78.3 20.7 142 77.5 171.9 151.6zm-149.1 0l-176.6 0c6.1-36.4 15.5-68.6 27-94.7c10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5c11.6 26 20.9 58.2 27 94.7zm-209 0L18.6 160C48.6 85.9 112.2 29.1 190.6 8.4C165.1 42.6 145.3 96.1 135.3 160zM8.1 192l123.1 0c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64L8.1 320C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zM194.7 446.6c-11.6-26-20.9-58.2-27-94.6l176.6 0c-6.1 36.4-15.5 68.6-27 94.6c-10.5 23.6-22.2 40.7-33.5 51.5C272.6 508.8 263.3 512 256 512s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6C112.2 482.9 48.6 426.1 18.6 352l116.7 0zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6c25.5-34.2 45.2-87.7 55.3-151.6l116.7 0z"/></svg>
						</a>
					</li>
					<li>
						<a rel="me" href="https://www.linkedin.com/in/ryanlewisrobinson">
							<span class="visually-hidden">LinkedIn</span>
							<svg xmlns="http://www.w3.org/2000/svg" height="40" width="40" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
						</a>
					</li>
					<li>
						<a rel="me" href="https://github.com/ryan-l-robinson">
							<span class="visually-hidden">GitHub</span>
							<svg xmlns="http://www.w3.org/2000/svg" height="40" width="40" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M448 96c0-35.3-28.7-64-64-64H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96zM265.8 407.7c0-1.8 0-6 .1-11.6c.1-11.4 .1-28.8 .1-43.7c0-15.6-5.2-25.5-11.3-30.7c37-4.1 76-9.2 76-73.1c0-18.2-6.5-27.3-17.1-39c1.7-4.3 7.4-22-1.7-45c-13.9-4.3-45.7 17.9-45.7 17.9c-13.2-3.7-27.5-5.6-41.6-5.6s-28.4 1.9-41.6 5.6c0 0-31.8-22.2-45.7-17.9c-9.1 22.9-3.5 40.6-1.7 45c-10.6 11.7-15.6 20.8-15.6 39c0 63.6 37.3 69 74.3 73.1c-4.8 4.3-9.1 11.7-10.6 22.3c-9.5 4.3-33.8 11.7-48.3-13.9c-9.1-15.8-25.5-17.1-25.5-17.1c-16.2-.2-1.1 10.2-1.1 10.2c10.8 5 18.4 24.2 18.4 24.2c9.7 29.7 56.1 19.7 56.1 19.7c0 9 .1 21.7 .1 30.6c0 4.8 .1 8.6 .1 10c0 4.3-3 9.5-11.5 8C106 393.6 59.8 330.8 59.8 257.4c0-91.8 70.2-161.5 162-161.5s166.2 69.7 166.2 161.5c.1 73.4-44.7 136.3-110.7 158.3c-8.4 1.5-11.5-3.7-11.5-8zm-90.5-54.8c-.2-1.5 1.1-2.8 3-3.2c1.9-.2 3.7 .6 3.9 1.9c.3 1.3-1 2.6-3 3c-1.9 .4-3.7-.4-3.9-1.7zm-9.1 3.2c-2.2 .2-3.7-.9-3.7-2.4c0-1.3 1.5-2.4 3.5-2.4c1.9-.2 3.7 .9 3.7 2.4c0 1.3-1.5 2.4-3.5 2.4zm-14.3-2.2c-1.9-.4-3.2-1.9-2.8-3.2s2.4-1.9 4.1-1.5c2 .6 3.3 2.1 2.8 3.4c-.4 1.3-2.4 1.9-4.1 1.3zm-12.5-7.3c-1.5-1.3-1.9-3.2-.9-4.1c.9-1.1 2.8-.9 4.3 .6c1.3 1.3 1.8 3.3 .9 4.1c-.9 1.1-2.8 .9-4.3-.6zm-8.5-10c-1.1-1.5-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3c1.1 1.5 1.1 3.3 0 4.1c-.9 .6-2.6 0-3.7-1.5zm-6.3-8.8c-1.1-1.3-1.3-2.8-.4-3.5c.9-.9 2.4-.4 3.5 .6c1.1 1.3 1.3 2.8 .4 3.5c-.9 .9-2.4 .4-3.5-.6zm-6-6.4c-1.3-.6-1.9-1.7-1.5-2.6c.4-.6 1.5-.9 2.8-.4c1.3 .7 1.9 1.8 1.5 2.6c-.4 .9-1.7 1.1-2.8 .4z"/></svg>
						</a>
					</li>
					<li>
						<a rel="me" href="https://dev.to/ryanr">
							<span class="visually-hidden">Dev.To</span>
							<svg xmlns="http://www.w3.org/2000/svg" height="40" width="40" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M120.1 208.3c-3.9-2.9-7.8-4.4-11.7-4.4H91v104.5h17.5c3.9 0 7.8-1.5 11.7-4.4 3.9-2.9 5.8-7.3 5.8-13.1v-69.7c0-5.8-2-10.2-5.8-13.1zM404.1 32H43.9C19.7 32 .1 51.6 0 75.8v360.4C.1 460.4 19.7 480 43.9 480h360.2c24.2 0 43.8-19.6 43.9-43.8V75.8c-.1-24.2-19.7-43.8-43.9-43.8zM154.2 291.2c0 18.8-11.6 47.3-48.4 47.3h-46.4V173h47.4c35.4 0 47.4 28.5 47.4 47.3l0 70.9zm100.7-88.7H201.6v38.4h32.6v29.6H201.6v38.4h53.3v29.6h-62.2c-11.2 .3-20.4-8.5-20.7-19.7V193.7c-.3-11.2 8.6-20.4 19.7-20.7h63.2l0 29.5zm103.6 115.3c-13.2 30.8-36.9 24.6-47.4 0l-38.5-144.8h32.6l29.7 113.7 29.6-113.7h32.6l-38.5 144.8z"/></svg>
						</a>
					</li>
					<li>
						<a rel="me" href="https://mstdn.ca/@Ryan">
							<span class="visually-hidden">Mastodon</span>
							<svg xmlns="http://www.w3.org/2000/svg" height="40" width="40" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54a102.5 102.5 0 0 1 -.9-13.9c85.6 20.9 158.7 9.1 178.8 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.3V197c0-58.5-64-56.6-64-6.9v114.2H90.2c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175z"/></svg>
						</a>
					</li>
					<li>
						<a rel="me" href="https://bsky.app/profile/ryanrobinson.ca">
							<span class="visually-hidden">Bluesky</span>
							<svg xmlns="http://www.w3.org/2000/svg" height="40" width="40" viewBox="0 0 576 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M407.8 294.7c-3.3-.4-6.7-.8-10-1.3c3.4 .4 6.7 .9 10 1.3zM288 227.1C261.9 176.4 190.9 81.9 124.9 35.3C61.6-9.4 37.5-1.7 21.6 5.5C3.3 13.8 0 41.9 0 58.4S9.1 194 15 213.9c19.5 65.7 89.1 87.9 153.2 80.7c3.3-.5 6.6-.9 10-1.4c-3.3 .5-6.6 1-10 1.4C74.3 308.6-9.1 342.8 100.3 464.5C220.6 589.1 265.1 437.8 288 361.1c22.9 76.7 49.2 222.5 185.6 103.4c102.4-103.4 28.1-156-65.8-169.9c-3.3-.4-6.7-.8-10-1.3c3.4 .4 6.7 .9 10 1.3c64.1 7.1 133.6-15.1 153.2-80.7C566.9 194 576 75 576 58.4s-3.3-44.7-21.6-52.9c-15.8-7.1-40-14.9-103.2 29.8C385.1 81.9 314.1 176.4 288 227.1z"/></svg>
						</a>
					</li>
					<li>
						<a rel="me" href="/feed/feed.xml" aria-label="rss">
							<span class="visually-hidden">RSS Feed</span>
							<svg xmlns="http://www.w3.org/2000/svg" height="40" width="40" viewBox="0 0 448 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg>
						</a>
					</li>
				</ul>
				<p>&copy; 2024 Ryan Robinson. Powered by <a href="https://www.11ty.dev/">Eleventy</a> on <a href="https://pages.github.com/">GitHub Pages</a>. The site's font is <a href="https://brailleinstitute.org/freefont">Atkinson Hyperlegible from the Braille Institute</a>.</p>
			</div>
		</footer>

		<!-- This page `/posts/2023/paragraphs-sidebar/` was built on 2024-09-06T17:14:26.520Z -->
	</body>
</html>